{
  "hash": "a676ff2d05c0e47a16f52cc2277b443c",
  "result": {
    "engine": "knitr",
    "markdown": "# Introduction to `SummarizedExperiment`\n\n<!-- This is taken from the summarizedExperiment package vignette -->\n\nThe `SummarizedExperiment` class is used to store rectangular matrices of\nexperimental results, which are commonly produced by sequencing and microarray\nexperiments.  Each object stores observations of one or more samples, along\nwith additional meta-data describing both the observations (features) and\nsamples (phenotypes).\n\nA key aspect of the `SummarizedExperiment` class is the coordination of the\nmeta-data and assays when subsetting. For example, if you want to exclude a\ngiven sample you can do for both the meta-data and assay in one operation,\nwhich ensures the meta-data and observed data will remain in sync.  Improperly\naccounting for meta and observational data has resulted in a number of\nincorrect results and retractions so this is a very desirable\nproperty.\n\n`SummarizedExperiment` is in many ways similar to the historical\n`ExpressionSet`, the main distinction being that `SummarizedExperiment` is more\nflexible in it's row information, allowing both `GRanges` based as well as those\ndescribed by arbitrary `DataFrame`s.  This makes it ideally suited to a variety\nof experiments, particularly sequencing based experiments such as RNA-Seq and\nChIp-Seq.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBiocManager::install('airway')\nBiocManager::install('SummarizedExperiment')\n```\n:::\n\n\n##  Anatomy of a `SummarizedExperiment`\n\nThe _SummarizedExperiment_ package contains two classes: \n`SummarizedExperiment` and `RangedSummarizedExperiment`.\n\n`SummarizedExperiment` is a matrix-like container where rows represent features\nof interest (e.g. genes, transcripts, exons, etc.) and columns represent\nsamples. The objects contain one or more assays, each represented by a\nmatrix-like object of numeric or other mode. The rows of a\n`SummarizedExperiment` object represent features of interest.  Information\nabout these features is stored in a `DataFrame` object, accessible using the\nfunction `rowData()`. Each row of the `DataFrame` provides information on the\nfeature in the corresponding row of the `SummarizedExperiment` object. Columns\nof the DataFrame represent different attributes of the features of interest,\ne.g., gene or transcript IDs, etc.\n\n`RangedSummarizedExperiment` is the \"child\"\" of the `SummarizedExperiment` class\nwhich means that all the methods on `SummarizedExperiment` also work on a\n`RangedSummarizedExperiment`.\n\nThe fundamental difference between the two classes is that the rows of a\n`RangedSummarizedExperiment` object represent genomic ranges of interest\ninstead of a `DataFrame` of features. The `RangedSummarizedExperiment` ranges\nare described by a `GRanges` or a `GRangesList` object, accessible using the\n`rowRanges()` function.\n\n@fig-se-diagram displays the class geometry and highlights the\nvertical (column) and horizontal (row) relationships.\n\n\n![Summarized Experiment. There are three main components, the `colData()`, the `rowData()` and the `assays()`. The accessors for the various parts of a complete SummarizedExperiment object match the names. ](images/se.png){#fig-se-diagram}\n\n### Assays\n\nThe `airway` package contains an example dataset from an RNA-Seq experiment of\nread counts per gene for airway smooth muscles.  These data are stored\nin a `RangedSummarizedExperiment` object which contains 8 different\nexperimental and assays 64,102 gene transcripts.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: airway\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(SummarizedExperiment)\ndata(airway, package=\"airway\")\nse <- airway\nse\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 63677 8 \nmetadata(1): ''\nassays(1): counts\nrownames(63677): ENSG00000000003 ENSG00000000005 ... ENSG00000273492\n  ENSG00000273493\nrowData names(10): gene_id gene_name ... seq_coord_system symbol\ncolnames(8): SRR1039508 SRR1039509 ... SRR1039520 SRR1039521\ncolData names(9): SampleName cell ... Sample BioSample\n```\n\n\n:::\n:::\n\n\nTo retrieve the experiment data from a `SummarizedExperiment` object one can\nuse the `assays()` accessor.  An object can have multiple assay datasets\neach of which can be accessed using the `$` operator.\nThe `airway` dataset contains only one assay (`counts`).  Here each row\nrepresents a gene transcript and each column one of the samples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nassays(se)$counts\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|                | SRR1039508| SRR1039509| SRR1039512| SRR1039513| SRR1039516| SRR1039517| SRR1039520| SRR1039521|\n|:---------------|----------:|----------:|----------:|----------:|----------:|----------:|----------:|----------:|\n|ENSG00000000003 |        679|        448|        873|        408|       1138|       1047|        770|        572|\n|ENSG00000000005 |          0|          0|          0|          0|          0|          0|          0|          0|\n|ENSG00000000419 |        467|        515|        621|        365|        587|        799|        417|        508|\n|ENSG00000000457 |        260|        211|        263|        164|        245|        331|        233|        229|\n|ENSG00000000460 |         60|         55|         40|         35|         78|         63|         76|         60|\n|ENSG00000000938 |          0|          0|          2|          0|          1|          0|          0|          0|\n|ENSG00000000971 |       3251|       3679|       6177|       4252|       6721|      11027|       5176|       7995|\n|ENSG00000001036 |       1433|       1062|       1733|        881|       1424|       1439|       1359|       1109|\n|ENSG00000001084 |        519|        380|        595|        493|        820|        714|        696|        704|\n|ENSG00000001167 |        394|        236|        464|        175|        658|        584|        360|        269|\n\n\n:::\n:::\n\n\n### 'Row' (regions-of-interest) data\n\nThe `rowRanges()` accessor is used to view the range information for a\n`RangedSummarizedExperiment`. (Note if this were the parent \n`SummarizedExperiment` class we'd use `rowData()`). The data are stored in a \n`GRangesList` object, where each list element corresponds to one gene \ntranscript and the ranges in each `GRanges` correspond to the exons in the\ntranscript.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrowRanges(se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGRangesList object of length 63677:\n$ENSG00000000003\nGRanges object with 17 ranges and 2 metadata columns:\n       seqnames            ranges strand |   exon_id       exon_name\n          <Rle>         <IRanges>  <Rle> | <integer>     <character>\n   [1]        X 99883667-99884983      - |    667145 ENSE00001459322\n   [2]        X 99885756-99885863      - |    667146 ENSE00000868868\n   [3]        X 99887482-99887565      - |    667147 ENSE00000401072\n   [4]        X 99887538-99887565      - |    667148 ENSE00001849132\n   [5]        X 99888402-99888536      - |    667149 ENSE00003554016\n   ...      ...               ...    ... .       ...             ...\n  [13]        X 99890555-99890743      - |    667156 ENSE00003512331\n  [14]        X 99891188-99891686      - |    667158 ENSE00001886883\n  [15]        X 99891605-99891803      - |    667159 ENSE00001855382\n  [16]        X 99891790-99892101      - |    667160 ENSE00001863395\n  [17]        X 99894942-99894988      - |    667161 ENSE00001828996\n  -------\n  seqinfo: 722 sequences (1 circular) from an unspecified genome\n\n...\n<63676 more elements>\n```\n\n\n:::\n:::\n\n\n### 'Column' (sample) data\n\nSample meta-data describing the samples can be accessed using `colData()`, and\nis a `DataFrame` that can store any number of descriptive columns for each\nsample row.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolData(se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDataFrame with 8 rows and 9 columns\n           SampleName     cell      dex    albut        Run avgLength\n             <factor> <factor> <factor> <factor>   <factor> <integer>\nSRR1039508 GSM1275862  N61311     untrt    untrt SRR1039508       126\nSRR1039509 GSM1275863  N61311     trt      untrt SRR1039509       126\nSRR1039512 GSM1275866  N052611    untrt    untrt SRR1039512       126\nSRR1039513 GSM1275867  N052611    trt      untrt SRR1039513        87\nSRR1039516 GSM1275870  N080611    untrt    untrt SRR1039516       120\nSRR1039517 GSM1275871  N080611    trt      untrt SRR1039517       126\nSRR1039520 GSM1275874  N061011    untrt    untrt SRR1039520       101\nSRR1039521 GSM1275875  N061011    trt      untrt SRR1039521        98\n           Experiment    Sample    BioSample\n             <factor>  <factor>     <factor>\nSRR1039508  SRX384345 SRS508568 SAMN02422669\nSRR1039509  SRX384346 SRS508567 SAMN02422675\nSRR1039512  SRX384349 SRS508571 SAMN02422678\nSRR1039513  SRX384350 SRS508572 SAMN02422670\nSRR1039516  SRX384353 SRS508575 SAMN02422682\nSRR1039517  SRX384354 SRS508576 SAMN02422673\nSRR1039520  SRX384357 SRS508579 SAMN02422683\nSRR1039521  SRX384358 SRS508580 SAMN02422677\n```\n\n\n:::\n:::\n\n\nThis sample metadata can be accessed using the `$` accessor which makes it \neasy to subset the entire object by a given phenotype.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset for only those samples treated with dexamethasone\nse[, se$dex == \"trt\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 63677 4 \nmetadata(1): ''\nassays(1): counts\nrownames(63677): ENSG00000000003 ENSG00000000005 ... ENSG00000273492\n  ENSG00000273493\nrowData names(10): gene_id gene_name ... seq_coord_system symbol\ncolnames(4): SRR1039509 SRR1039513 SRR1039517 SRR1039521\ncolData names(9): SampleName cell ... Sample BioSample\n```\n\n\n:::\n:::\n\n\n### Experiment-wide metadata\n\nMeta-data describing the experimental methods and publication references can be\naccessed using `metadata()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata(se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\nExperiment data\n  Experimenter name: Himes BE \n  Laboratory: NA \n  Contact information:  \n  Title: RNA-Seq transcriptome profiling identifies CRISPLD2 as a glucocorticoid responsive gene that modulates cytokine function in airway smooth muscle cells. \n  URL: http://www.ncbi.nlm.nih.gov/pubmed/24926665 \n  PMIDs: 24926665 \n\n  Abstract: A 226 word abstract is available. Use 'abstract' method.\n```\n\n\n:::\n:::\n\n\nNote that `metadata()` is just a simple list, so it is appropriate for _any_\nexperiment wide metadata the user wishes to save, such as storing model\nformulas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmetadata(se)$formula <- counts ~ dex + albut\n\nmetadata(se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\nExperiment data\n  Experimenter name: Himes BE \n  Laboratory: NA \n  Contact information:  \n  Title: RNA-Seq transcriptome profiling identifies CRISPLD2 as a glucocorticoid responsive gene that modulates cytokine function in airway smooth muscle cells. \n  URL: http://www.ncbi.nlm.nih.gov/pubmed/24926665 \n  PMIDs: 24926665 \n\n  Abstract: A 226 word abstract is available. Use 'abstract' method.\n\n$formula\ncounts ~ dex + albut\n```\n\n\n:::\n:::\n\n\n## Common operations on `SummarizedExperiment`\n\n### Subsetting\n\n- `[` Performs two dimensional subsetting, just like subsetting a matrix\n    or data frame.\n\n::: {.cell}\n\n```{.r .cell-code}\n# subset the first five transcripts and first three samples\nse[1:5, 1:3]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 5 3 \nmetadata(2): '' formula\nassays(1): counts\nrownames(5): ENSG00000000003 ENSG00000000005 ENSG00000000419\n  ENSG00000000457 ENSG00000000460\nrowData names(10): gene_id gene_name ... seq_coord_system symbol\ncolnames(3): SRR1039508 SRR1039509 SRR1039512\ncolData names(9): SampleName cell ... Sample BioSample\n```\n\n\n:::\n:::\n\n- `$` operates on `colData()` columns, for easy sample extraction.\n\n::: {.cell}\n\n```{.r .cell-code}\nse[, se$cell == \"N61311\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 63677 2 \nmetadata(2): '' formula\nassays(1): counts\nrownames(63677): ENSG00000000003 ENSG00000000005 ... ENSG00000273492\n  ENSG00000273493\nrowData names(10): gene_id gene_name ... seq_coord_system symbol\ncolnames(2): SRR1039508 SRR1039509\ncolData names(9): SampleName cell ... Sample BioSample\n```\n\n\n:::\n:::\n\n\n### Getters and setters\n\n- `rowRanges()` / (`rowData()`), `colData()`, `metadata()`\n\n::: {.cell}\n\n```{.r .cell-code}\ncounts <- matrix(1:15, 5, 3, dimnames=list(LETTERS[1:5], LETTERS[1:3]))\n\ndates <- SummarizedExperiment(assays=list(counts=counts),\n                              rowData=DataFrame(month=month.name[1:5], day=1:5))\n\n# Subset all January assays\ndates[rowData(dates)$month == \"January\", ]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: SummarizedExperiment \ndim: 1 3 \nmetadata(0):\nassays(1): counts\nrownames(1): A\nrowData names(2): month day\ncolnames(3): A B C\ncolData names(0):\n```\n\n\n:::\n:::\n\n\n- `assay()` versus `assays()`\nThere are two accessor functions for extracting the assay data from a\n`SummarizedExperiment` object.  `assays()` operates on the entire list of assay\ndata as a whole, while `assay()` operates on only one assay at a time.\n`assay(x, i)` is simply a convenience function which is equivalent to\n`assays(x)[[i]]`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nassays(se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of length 1\nnames(1): counts\n```\n\n\n:::\n\n```{.r .cell-code}\nassays(se)[[1]][1:5, 1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516\nENSG00000000003        679        448        873        408       1138\nENSG00000000005          0          0          0          0          0\nENSG00000000419        467        515        621        365        587\nENSG00000000457        260        211        263        164        245\nENSG00000000460         60         55         40         35         78\n```\n\n\n:::\n\n```{.r .cell-code}\n# assay defaults to the first assay if no i is given\nassay(se)[1:5, 1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516\nENSG00000000003        679        448        873        408       1138\nENSG00000000005          0          0          0          0          0\nENSG00000000419        467        515        621        365        587\nENSG00000000457        260        211        263        164        245\nENSG00000000460         60         55         40         35         78\n```\n\n\n:::\n\n```{.r .cell-code}\nassay(se, 1)[1:5, 1:5]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516\nENSG00000000003        679        448        873        408       1138\nENSG00000000005          0          0          0          0          0\nENSG00000000419        467        515        621        365        587\nENSG00000000457        260        211        263        164        245\nENSG00000000460         60         55         40         35         78\n```\n\n\n:::\n:::\n\n\n### Range-based operations\n\n- `subsetByOverlaps()`\n`SummarizedExperiment` objects support all of the `findOverlaps()` methods and\nassociated functions.  This includes `subsetByOverlaps()`, which makes it easy\nto subset a `SummarizedExperiment` object by an interval.\n\nIn tne next code block, we define a region of interest (or many regions of interest)\nand then subset our `SummarizedExperiment` by overlaps with this region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Subset for only rows which are in the interval 100,000 to 110,000 of\n# chromosome 1\nroi <- GRanges(seqnames=\"1\", ranges=100000:1100000)\nsub_se = subsetByOverlaps(se, roi)\nsub_se\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 74 8 \nmetadata(2): '' formula\nassays(1): counts\nrownames(74): ENSG00000131591 ENSG00000177757 ... ENSG00000272512\n  ENSG00000273443\nrowData names(10): gene_id gene_name ... seq_coord_system symbol\ncolnames(8): SRR1039508 SRR1039509 ... SRR1039520 SRR1039521\ncolData names(9): SampleName cell ... Sample BioSample\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(sub_se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 74  8\n```\n\n\n:::\n:::\n\n\n\n## Constructing a `SummarizedExperiment` \n\nOften, `SummarizedExperiment` or `RangedSummarizedExperiment` objects are \nreturned by functions written by other packages. However it is possible to \ncreate them by hand with a call to the `SummarizedExperiment()` constructor. \nThe code below is simply to illustrate the mechanics of creating an object\nfrom scratch. In practice, you will probably have the pieces of the \nobject from other sources such as Excel files or csv files. \n\nConstructing a `RangedSummarizedExperiment` with a `GRanges` as the\n_rowRanges_ argument:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrows <- 200\nncols <- 6\ncounts <- matrix(runif(nrows * ncols, 1, 1e4), nrows)\nrowRanges <- GRanges(rep(c(\"chr1\", \"chr2\"), c(50, 150)),\n                     IRanges(floor(runif(200, 1e5, 1e6)), width=100),\n                     strand=sample(c(\"+\", \"-\"), 200, TRUE),\n                     feature_id=sprintf(\"ID%03d\", 1:200))\ncolData <- DataFrame(Treatment=rep(c(\"ChIP\", \"Input\"), 3),\n                     row.names=LETTERS[1:6])\n\nSummarizedExperiment(assays=list(counts=counts),\n                     rowRanges=rowRanges, colData=colData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: RangedSummarizedExperiment \ndim: 200 6 \nmetadata(0):\nassays(1): counts\nrownames: NULL\nrowData names(1): feature_id\ncolnames(6): A B ... E F\ncolData names(1): Treatment\n```\n\n\n:::\n:::\n\n\nA `SummarizedExperiment` can be constructed with or without supplying\na `DataFrame` for the _rowData_ argument:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSummarizedExperiment(assays=list(counts=counts), colData=colData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nclass: SummarizedExperiment \ndim: 200 6 \nmetadata(0):\nassays(1): counts\nrownames: NULL\nrowData names(0):\ncolnames(6): A B ... E F\ncolData names(1): Treatment\n```\n\n\n:::\n:::\n\n\n\n",
    "supporting": [
      "bioc-summarizedexperiment_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}